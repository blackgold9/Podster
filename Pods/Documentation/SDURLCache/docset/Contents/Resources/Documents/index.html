<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>SDURLCache 1.2 Reference</title>
		<link rel="stylesheet" type="text/css" href="css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.0.5 (build 789)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="index.html">SDURLCache 1.2 </a></h1>
				<a id="developerHome" href="index.html">Olivier Poitrey</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">SDURLCache 1.2 Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar"></ul>
		</header>
		<article>
			<div id="overview_contents" role="main">
				<div class="main-navigation navigation-top">
					<a href="hierarchy.html">Next</a>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">SDURLCache 1.2 Reference</h1>
					</div>		
				</div>
				<div id="container">
					
					<div class="section section-overview index-overview">
						
						
						<p>On iPhone OS, Apple did remove on-disk cache support for unknown reason. Some will say it&rsquo;s to save
flash-drive life, others will arg it&rsquo;s to save disk capacity. As it is explained in the
NSURLCacheStoragePolicy, the NSURLCacheStorageAllowed constant is always treated as
NSURLCacheStorageAllowedInMemoryOnly and there is no way to force it back, the code is certainly
gone on this platform. For whatever reason Apple removed this feature, you may be interested by
having on-disk HTTP request caching in your application. <a href="Classes/SDURLCache.html">SDURLCache</a> gives back this feature to this
iPhone OS for you.</p>

<p>To use it, you just have create an instance, replace the default shared NSURLCache with it and
that&rsquo;s it, you instantly give on-disk HTTP request caching capability to your application.</p>

<pre><code>SDURLCache *urlCache = [[SDURLCache alloc] initWithMemoryCapacity:1024*1024   // 1MB mem cache
                                                     diskCapacity:1024*1024*5 // 5MB disk cache
                                                         diskPath:[SDURLCache defaultCachePath]];
[NSURLCache setSharedURLCache:urlCache];
[urlCache release];
</code></pre>

<p>To save flash drive, <a href="Classes/SDURLCache.html">SDURLCache</a> doesn&rsquo;t cache on disk responses if cache expiration delay is lower
than 5 minutes by default. You can change this behavior by changing the <code>minCacheInterval</code> property.</p>

<p>Cache eviction is done automatically when disk capacity is outreached in a periodic maintenance
thread. All disk write operations are done in a separated thread so they can&rsquo;t block the main run
loop.</p>

<p>To control the caching behavior, use the <code>NSURLRequest</code>&rsquo;s <code>cachePolicy</code> property. If you want a
response not to be cached on disk but still in memory, you can implement the <code>NSURLConnection</code>
<code>connection:willCacheResponse:</code> delegate method and change the <code>NSURLCachedResponse</code> <code>storagePolicy</code>
property to <code>NSURLCacheStorageAllowedInMemoryOnly</code>. See example below:</p>

<pre><code>- (NSCachedURLResponse *)connection:(NSURLConnection *)connection
                  willCacheResponse:(NSCachedURLResponse *)cachedResponse
{
    NSCachedURLResponse *memOnlyCachedResponse =
        [[NSCachedURLResponse alloc] initWithResponse:cachedResponse.response
                                                 data:cachedResponse.data
                                             userInfo:cachedResponse.userInfo
                                        storagePolicy:NSURLCacheStorageAllowedInMemoryOnly];
    return [memOnlyCachedResponse autorelease];
}
</code></pre>
						
						
					</div>
					
                        
                    
					
					
					<div class="index-column">
						<h2 class="index-title">Class References</h2>
						<ul>
							
							<li><a href="Classes/SDURLCache.html">SDURLCache</a></li>
							
						</ul>
					</div>
					
					
					
				</div>
				<div class="main-navigation navigation-bottom">
					<a href="hierarchy.html">Next</a>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2012 Olivier Poitrey. All rights reserved. (Last updated: 2012-09-03)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.0.5 (build 789)</a>.</span></p>
						
	
					</div>
				</div>
			</div>
		</article>		
	</body>
</html>